<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" th:replace="~{common/layout :: layout(~{::title}, ~{::content}, ~{::css}, ~{::scripts})}">
<head>
    <meta charset="UTF-8">
    <title>게시판 목록</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <th:block th:fragment="css">
        <style>
            /* === 헤더 영역 ===*/
            .board-header{
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 30px;
                padding-bottom: 20px;
                border-bottom: 2px solid #333;
            }
            .total-count{
                font-size: 16px;
                color: #495057;
            }
            .total-count strong{
                font-size: 1.2rem;
                color: #007bff;
            }
            /* 글쓰기 버튼 */
            .btn-write{
                padding: 10px 20px;
                background-color: #007bff;
                text-decoration: none;
                color: white;
                border: none;
                border-radius: 4px;
                font-weight: 500;
                transition: background-color 0.3s;
            }
            .btn-write:hover{
                background-color: #0056b3;
                cursor: pointer;
            }
            /* === 게시판 테이블 === */
            .board-table{
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
            }
            /* .board-table thead{} */
            .boarder-table th{
                text-align: center;
                vertical-align: middle;
                font-weight: bold;
                padding: 12px 10px;
                background-color: #f8f9fa;
                border-bottom: 2px solid #dee2eb;
            }
            .board-table td{
                padding: 15px 10px;
                transition: background-color 0.2s;
                vertical-align: middle;
            }
            .board-table tbody tr{
                border-bottom: 1px solid #e9ecef;
                transition: background-color 0.2s;
            }
            .board-table tbody tr:hover{
                background-color: #f8f9fa;
                cursor: pointer;
            }
            .board-table td.center{
                text-align: center;
                vertical-align: middle;
            }
            .board-table td.title{
                text-align: left;
                padding-left: 15px;
            }
            .board-table td.title a{
                text-decoration: none;
                color: #333;
                transition: color 0.2s;
            }
            .board-table td.title a:hover{
                color: #007bff;
                text-decoration: underline;
            }
            /* 댓글 수 */
            .comment-count{
                font-size: 0.9rem;
                color: #666;
                margin-left: 5px;
            }
            /* === 카테고리 배치 ===*/
            .category-badge{
                display: inline-block;
                padding: 4px 12px;
                border-radius: 12px;
                font-size: 12px;
                font-weight: bold;
                white-space: nowrap;
                background-color: #e9ecef;
            }
            /* 공지사항 카테고리 - 빨간색 */
            .category-badge.NOTICE{
                background-color: #ff6b6b;
                color: white;
            }
            /* 자유게시판 카테고리 - 파란색 */
            .category-badge.FREE{
                background-color: #4ecdc4;
                color: white;
            }
            /* 질문게시판 카테고리 - 노란색 */
            .category-badge.QNA{
                background-color: #ffd93d;
                color: #333;
            }
            /* 리뷰 카테고리 - 연두색 */
            .category-badge.REVIEW{
                background-color: #a8e6cf;
                color: #2d5f3f;
            }
            /* === 페이징 영역 === */
            .pagination{
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 5px;
                margin-top: 40px;
                padding: 20px 0;
            }
            .pagination a{
                text-decoration: none;
            }
            .page-btn{
                min-width: 35px;
                height: 35px;
                padding: 8px 12px;
                border: 1px solid #ddd;
                background-color: #fff;
                color: #333;
                text-decoration: none;
                border-radius: 4px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                transition: all 0.2s;
            }
            .page-btn:hover{
                background-color: #f8f9fa;
                border-color: #ccc;
                color: #007bff;
            }
            /* 현재 페이지(활성화된 버튼) */
            .page-btn.active{
                background-color: #007bff;
                color: white;
                border-color: #007bff;
                pointer-events: none;
                font-weight: bold;
            }
            .page-btn.active:hover{
                background-color: #0056b3;
                color: white;
                border-color: #0056b3;
                cursor: default;
            }
            /* 이전/다음 그룹 버튼(<< 이전, 다음 >>) */
            .page-btn.nav{
                font-weight: bold;
            }
            /* 비활성 버튼 상태(클릭 불가 상태) */
            .page-btn.disabled{
                pointer-events: none;
                color: #cccc;
                border-color: #e9ecef;
                cursor:not-allowed;
                background-color: #f8f9fa;
            }
        </style>
    </th:block>
</head>
<body>
    <!-- 메인 컨텐츠 영역 -->
    <div th:fragment="content">
        <div class="container my-4">
            <h1 class="mb-4">📋 게시판</h1>
            <!-- === 헤더 : 전체 게시글 수 & 글쓰기 버튼 === -->
            <div class="board-header">
                <!-- 전체 게시글 수 -->
                <div class="total-count">
                    전체 게시글 수: <strong th:text="${totalElements}">0</strong>개
                </div>
                <!-- 글쓰기 버튼 (로그인한 사용자만 표시) -->
                <a th:href="@{/boards/new}" class="btn-write" sec:authorize="isAuthenticated()">
                    ✏️ 글쓰기
                </a>
            </div>
            <!-- === 게시판 목록 테이블 (게시글이 있을 때만 표시) === -->
            <table class="board-table" th:if="${boards.hasContent()}">
                <thead>
                    <tr class="center">
                        <th style="width: 80px; text-align: center;">번호</th>
                        <th style="width: 120px; text-align: center;">카테고리</th>
                        <th style="text-align: center;">제목</th>
                        <th style="width: 120px; text-align: center;">작성자</th>
                        <th style="width: 80px; text-align: center;">조회</th>
                        <th style="width: 80px; text-align: center;">좋아요</th>
                        <th style="width: 150px; text-align: center;">작성일</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- boards.content를 반복하며 각 게시글 출력 -->
                    <!-- th:each 타임리프 반복문 -->
                    <tr th:each="board : ${boards.content}" class="mb-4">
                        <td class="center" th:text="${board.id}">1</td>
                        <td class="center">
                            <!-- th:classappend : 기존 class에 동적으로 class 추가 -->
                            <!-- board.category.name() -->
                            <!-- board.category.displayname : enum의 displayname -->
                            <span class="category-badge" th:classappend="${board.category.name()}" th:text="${board.category.displayName}">일반</span>
                        </td>
                        <!-- 제목 (클릭 시 상세 페이지로 이동) -->
                        <td class="title">
                            <a th:href="@{/boards/{id}(id=${board.id})}" th:text="${board.title}">게시글 제목</a>
                            <!-- 댓글 수 (댓글 있을때만) -->
                            <span class="comment-count" th:if="${board.commentCount > 0}" th:text="|[${board.commentCount}]|">(0)</span>
                        </td>
                        <td class="center" th:text="${board.authorName}">작성자</td>
                        <td class="center" th:text="${board.viewCount}">0</td>
                        <td class="center" th:text="${board.likeCount}">0</td>
                        <!-- 작성 일시 -->
                        <!-- #temperals: 타임리프의 날짜/시간 유틸리티 -->
                        <td class="center" th:text="${#temporals.format(board.createdAt, 'yyyy-MM-dd HH:mm')}">2024-01-01 12:00</td>
                    </tr>
                </tbody>
            </table>
            <!-- === 게시글이 없을 때 표시 === -->
            <div th:if="${!boards.hasContent()}" class="empty-list">
                현재 등록된 게시글이 없습니다.
                <span sec:authorize="isAuthenticated()">
                    <a th:href="@{/boards/new}">첫 번째 글을 작성해보세요!</a>
                </span>
                <span sec:authorize="isAnonymous()">
                    <a th:href="@{/auth/login}">로그인</a> 후 글을 작성할 수 있습니다.
                </span>
            </div>
            <!-- === 페이징 처리 === -->
            <div class="pagination" th:if="${boards.hasContent()}">
                <a th:href="${hasPrevGroup} ? @{/boards(page=${prevGroupPage},size=10)} : '#'" th:classappend="${!hasPrevGroup} ? 'disabled' : '' " class="page-btn nav"> <<이전 </a>
                <!-- 페이지 번호 버튼들 -->
                <!-- <span th:each="i : ${#numbers.sequence(startPage, endPage)}">
                    <a th:href="@{/boards(page=${i},size=10)}"
                    th:text="${i}"
                    th:classappend="${i == currentPage} ? 'active' : ''" class="page-btn">1</a>
                </span> -->
                <a th:each="pageNum : ${#numbers.sequence(startPage, endPage)}" th:href="@{/boards(page=${pageNum},size=10)}" th:text="${pageNum}" th:classappend="${pageNum == currentPage} ? 'active' : '' " class="page-btn"></a>
                <a th:href="${hasNextGroup} ? @{/boards(page=${nextGroupPage},size=10)} : '#'" th:classappend="${!hasNextGroup} ? 'disabled' : '' " class="page-btn nav">이후>></a>
            </div>
        </div>
    </div>
    <!-- 게시판 전용 JavaScript -->
    <div th:fragment="scripts"></div>
</body>
</html>